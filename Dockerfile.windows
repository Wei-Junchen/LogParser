# 使用预编译的 MXE Docker 镜像
FROM dockcross/windows-static-x64

# 安装额外依赖
RUN apt-get update && apt-get install -y \
    git \
    && rm -rf /var/lib/apt/lists/*

# 设置工作目录
WORKDIR /work

# 复制项目文件
COPY . /work/

# 创建构建脚本
RUN echo '#!/bin/bash\n\
mkdir -p build-win && cd build-win\n\
cmake .. -DCMAKE_BUILD_TYPE=Release\n\
make -j$(nproc)\n\
' > /build.sh && chmod +x /build.sh

CMD ["/build.sh"]
